<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@3.0.3/dist/aframe-event-set-component.min.js"></script>
    <script src="https://unpkg.com/super-hands@^3.0.1/dist/super-hands.min.js"></script>
    <!-- new version but doesn't contain right physics elements -->
    <!-- <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script> -->
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v3.13.1/dist/aframe-extras.min.js"></script>
    <title>Document</title>
    <script>
        // forward mouse and touch events to the super-hands entity
        AFRAME.registerComponent('capture-mouse', {
            init: function () {
                this.eventRepeater = this.eventRepeater.bind(this)
                this.el.sceneEl.addEventListener('loaded', () => {
                    this.el.sceneEl.canvas.addEventListener('mousedown', this.eventRepeater)
                    this.el.sceneEl.canvas.addEventListener('mouseup', this.eventRepeater)
                    this.el.sceneEl.canvas.addEventListener('touchstart', this.eventRepeater)
                    this.el.sceneEl.canvas.addEventListener('touchmove', this.eventRepeater)
                    this.el.sceneEl.canvas.addEventListener('touchend', this.eventRepeater)
                }, {
                    once: true
                })
            },
            eventRepeater: function (evt) {
                if (evt.type.startsWith('touch')) {
                    evt.preventDefault()
                    // avoid repeating touchmove because it interferes with look-controls
                    if (evt.type === 'touchmove') {
                        return
                    }
                }
                this.el.emit(evt.type, evt.detail)
            }
        })
    </script>
</head>

<body>
    <a-scene>
        <a-assets>
            <img id="texture" src="assets/code.jpg">
            <a-mixin id="cube" geometry="primitive: box; width: 1; height: 1; depth: 1" hoverable grabbable stretchable
                draggable droppable event-set__hoveron="_event: hover-start; material.opacity: 0.7; transparent: true"
                event-set__hoveroff="_event: hover-end; material.opacity: 1; transparent: false" body="shape: box"
                shadow>
            </a-mixin>
        </a-assets>
        <a-entity camera look-controls wasd-controls position="0 1 1" capture-mouse raycaster cursor="rayOrigin:mouse"
            body="type: static; shape: sphere; sphereRadius: 0.001" super-hands="colliderEvent: raycaster-intersection;
                             colliderEventProperty: els;
                             colliderEndEvent:raycaster-intersection-cleared;
                             colliderEndEventProperty: clearedEls;">
        </a-entity>
        <a-entity class="cube" mixin="cube" position="0 0.265 -1" material="color: red"></a-entity>
        <a-box src="#texture" opacity="0.5" height="10" width="10" position="0 0 -5" rotation="0 0 0"
            animation__mouseenter="property: rotation; to: 180 0 0; dur: 5000; easing: easeOutElastic; loop: false; delay: 2000">
        </a-box>
        <a-box box-item color="#890088" height="10" width="10" position="0 -5 0" rotation="90 90 90"
            event-set__down="_event: mousedown; rotation: 0 90 0; dur: 500"></a-box>
        <a-box color="#900900" height="10" width="10" position="5 0 0" rotation="0 90 0"></a-box>
        <a-box src="#texture" height="10" width="10" position="-5 0 0" rotation="0 -90 0"></a-box>
        <a-box color="#060606" height="10" width="10" position="0 0 5" rotation="0 0 90"></a-box>
        <a-box color="#777777" height="10" width="10" position="0 5 0" rotation="90 0 90"></a-box>

        <!-- second room layer -->
        <a-box color="#900900" height="10" width="10" position="5 0 -5" rotation="0 90 0"></a-box>
        <a-box color="#777777" height="10" width="10" position="0 5 -5" rotation="90 0 90"></a-box>
        <a-box src="#texture" height="10" width="10" position="-5 0 -5" rotation="0 -90 0"></a-box>
    </a-scene>
</body>

</html>